timeutils
=========

GNU touch コマンドを MinGW でビルドして Windows で動くようにする予定です。まだ開発途中ですが、少しずつソースを公開していきます。時刻を取得したり、変更したりする関数のテスト用に作成したコマンドが利用できます。

Windows のコマンドをビルドする場合、Mingw-w64 と GNU make が必要です。64 ビットは `make`、32 ビットは `make x86` を実行すると、bin、x86 ディレクトリにそれぞれ作成されます。GNU C ライブラリ（GLIBC）や msvcrt.dll（MSVCRT）を使用したコマンドをビルドするには `make glibc`、`make msvcrt` を実行し、glibc、msvcrt ディレクトリに作成します。GLIBC のコマンドは gcc、make をインストールした GNU/Linux や Cygwin 上でビルドする必要があります。

2025-W49 現在、関数のテスト用に作成した下記のコマンドが使えます。localtime と mktime は同名の POSIX 関数を自作したコマンドが bin、x86 ディレクトリに、GLIBC や MSVCRT の関数を呼び出すコマンドが glibc、msvcrt に作成され、同じ引数を指定して各ライブラリとの動作の違いを確かめられます。

#### adjustday

コマンドの引数に年、月、日（負の値も可能）を指定すると、月と日を正しい範囲に修正して結果を表示します。MSVCRT のコマンドは作成されません。

#### currentft

現在の時刻を 1601-01-01 00:00 UTC からの 100 ナノ秒、または、1970-01-01 00:00 UTC からの秒で表示します。MSVCRT のコマンドは作成されません。

#### getft

コマンドの引数に指定したファイルの時刻を 1601-01-01 00:00 UTC からの 100 ナノ秒、または、1970-01-01 00:00 UTC からの秒で表示します。MSVCRT のコマンドは作成されません。

#### leapdays

コマンドの引数に２つの年（負の値も可能）を指定すると、その期間に含まれるうるう日の数を表示します。`-t` オプションを指定すると、400 で割り切れる年数、残りの 4 で割り切れる年数、4 年未満の各集計テーブルを表示します。MSVCRT のコマンドは作成されません。

#### localtime

コマンドの引数に 1970-01-01 00:00 UTC からの秒を指定すると、ローカル時刻に変換して年、月、日、時、分、秒を表示します。MSVCRT のコマンド以外では負の値も指定可能です。

#### mktime

[mktime コマンド](./mktime.md) を参照。

#### modifysec

コマンドの引数に指定した 1970-01-01 00:00 UTC からの秒や小数部分のナノ秒を変更した値を表示します。`-C` や `-F` オプションを指定すると、（小数部分をゼロに設定して）秒の値を切り上げたり、切り下げたりします。また、`-R` や `-P` オプションを指定すると、小数部分をランダムな値に設定したり、 桁を並べ替えたりします。MSVCRT のコマンドは作成されません。

日付や時刻を表示するコマンドでは曜日名、週番号、年内日数、UTC からのオフセット、夏時間かどうかを表示したり、元号、ISO 8601 の形式で表示したりすることができます。詳しくは各コマンドに `--help` を指定して使用方法を参照してください。

コマンドの最初の引数に負の値を指定する場合、引数の前に `--` を指定する必要があります。

## ライセンス

このプログラムは GPL v2.0 で公開されています。
